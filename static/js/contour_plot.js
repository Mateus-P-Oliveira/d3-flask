// contour_plot.js
// JavaScript code for creating the contour plot using D3.js

// Function to fetch data and create the contour plot
function createContourPlot() {
    // Fetch data from Flask endpoint
    fetch('/contour-data')
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            // Data processing and visualization using D3.js
            const X = data.X
            const Y = data.Y
            const Z = data.Z;

            // const X = [12.5, 17.5, 22.5, 27.5, 30.0, 32.5, 35.0, 37.5, 40.0, 42.5, 45.0, 47.5, 50.0, 52.5, 55.0, 57.5, 60.0, 62.5, 65.0, 67.5, 70.0, 72.5, 75.0, 77.5, 80.0, 82.5, 85.0, 87.5, 90.0, 92.5, 95.0, 97.5, 100.0, 102.5, 105.0, 107.5, 110.0, 112.5, 115.0, 117.5, 120.0, 122.5, 125.0, 127.5, 130.0, 132.5, 135.0, 137.5, 140.0, 142.5, 145.0, 147.5, 150.0, 152.5, 155.0, 157.5, 160.0, 162.5, 165.0, 167.5, 170.0, 172.5, 175.0, 177.5, 180.0, 182.5, 185.0, 187.5, 190.0, 192.5, 195.0, 197.5, 200.0, 202.5, 205.0, 207.5, 210.0, 212.5, 215.0, 217.5, 220.0, 222.5, 225.0, 227.5, 230.0, 232.5, 235.0, 237.5, 240.0, 242.5, 245.0, 247.5, 250.0, 252.5, 255.0, 257.5, 260.0, 262.5, 265.0, 267.5, 270.0, 272.5, 275.0, 277.5, 280.0, 282.5, 285.0, 287.5, 290.0, 292.5, 295.0, 297.5, 300.0, 302.5, 305.0, 307.5, 310.0, 312.5, 315.0, 317.5, 320.0, 322.5, 325.0, 327.5, 330.0, 332.5, 335.0, 337.5, 340.0, 342.5, 345.0, 347.5, 350.0, 352.5, 355.0, 357.5, 360.0, 362.5, 365.0, 367.5, 370.0, 372.5, 375.0, 377.5, 380.0, 382.5, 385.0, 387.5, 390.0, 392.5, 395.0, 397.5, 400.0, 402.5, 405.0, 407.5, 410.0, 412.5, 415.0, 417.5, 420.0, 422.5, 425.0, 427.5, 430.0, 432.5, 435.0, 437.5, 440.0, 442.5, 445.0, 447.5, 450.0, 452.5, 455.0, 457.5, 460.0, 462.5, 465.0, 467.5, 470.0, 472.5, 475.0, 477.5, 480.0, 482.5, 485.0, 487.5, 490.0, 492.5, 495.0, 497.5, 500.0, 502.5, 505.0, 507.5, 510.0, 512.5, 515.0, 517.5, 520.0, 522.5, 525.0, 527.5, 532.5, 537.5, 542.5]; // Valores do eixo x
            // const Y = [-54.0, -45.0, -36.0, -28.0, -27.0, -21.0, -18.0, -14.0, -10.0, -9.0, -7.0, -5.0, -3.0]; // Valores do eixo y
            // const Z = [
            //     [NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, 725.9567, 717.7081000000001, 709.4595, 700.32035, 691.1812, 656.57725, 621.9733, 627.72605, 633.4788, 630.0057999999999, 626.5328, 632.91345, 639.2941, 655.35475, 671.4154, 694.97645, 718.5375, 752.4225, 786.3075, 795.9884999999999, 805.6695, 811.1953, 816.7211, 821.5259, 826.3307, 793.7293500000001, 761.128, 770.01845, 778.9089, 774.5293, 770.1497, 781.3679, 792.5861, 791.42875, 790.2714, 769.31735, 748.3633, 752.2, 756.0367, 758.33545, 760.6342, 730.6804500000001, 700.7267, 694.43835, 688.15, 690.7202, 693.2904, 694.0831000000001, 694.8758, 693.44505, 692.0143, 689.7401, 687.4659, 684.73555, 682.0052, 670.00935, 658.0135, 646.864, 635.7145, 636.96045, 638.2064, 650.2899, 662.3734, 677.55295, 692.7325, 700.71055, 708.6886, 724.5900999999999, 740.4916, 761.0376, 781.5836, 799.32575, 817.0679, 803.58105, 790.0942, 794.6030000000001, 799.1118, 774.5508500000001, 749.9899, 739.6160500000001, 729.2422, 710.4548500000001, 691.6675, 680.1589, 668.6503, 674.619, 680.5877, 684.532, 688.4763, 694.0039, 699.5315, 695.985, 692.4385, 688.89095, 685.3434, 672.49645, 659.6495, 651.2418, 642.8341, 630.61195, 618.3898, 630.6344, 642.879, 648.61135, 654.3437, 680.2570000000001, 706.1703, 710.33695, 714.5036, 729.76815, 745.0327, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN], [NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, 690.9622, 688.5539, 686.1456, 689.6664, 693.1872, 691.5115499999999, 689.8359, 687.9727, 686.1095, 681.43055, 676.7516, 665.8729000000001, 654.9942, 635.90975, 616.8253, 598.3813, 579.9373, 568.90335, 557.8694, 557.86385, 557.8583, 578.50005, 599.1418, 623.7912, 648.4406, 676.5181, 704.5956, 739.41765, 774.2397, 791.7211, 809.2025, 819.9361, 830.6697, 842.2247500000001, 853.7798, 833.1657, 812.5516, 802.9889000000001, 793.4262, 796.2058999999999, 798.9856, 786.6025, 774.2194, 763.034, 751.8486, 748.9741, 746.0996, 747.6154, 749.1312, 729.61555, 710.0999, 686.7449, 663.3899, 663.5339, 663.6779, 658.56945, 653.461, 652.9132, 652.3654, 654.2665, 656.1676, 658.7045499999999, 661.2415, 652.5289, 643.8163, 627.2192, 610.6221, 600.87485, 591.1276, 596.61585, 602.1041, 627.53595, 652.9678, 670.9902999999999, 689.0128, 699.77235, 710.5319, 743.4281, 776.3243, 776.5144, 776.7045, 794.3868500000001, 812.0692, 797.3675499999999, 782.6659, 773.25955, 763.8532, 748.6450500000001, 733.4369, 718.3706500000001, 703.3044, 668.5342, 633.764, 634.7912, 635.8184, 638.921, 642.0236, 649.3603, 656.697, 655.9275, 655.158, 647.6003499999999, 640.0427, 620.40455, 600.7664, 595.8162, 590.866, 565.43815, 540.0103, 554.87375, 569.7372, 567.5226, 565.308, 582.5227, 599.7374, 612.6681, 625.5988, 627.59245, 629.5861, 635.1143, 640.6425, 632.8151, 624.9877, 621.89005, 618.7924, 624.30745, 629.8225, 640.58385, 651.3452, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN], [NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, 838.4608, 803.19, 767.9192, 732.1484499999999, 696.3777, 653.10815, 609.8386, 625.70975, 641.5809, 638.34455, 635.1082, 631.9693500000001, 628.8305, 638.51535, 648.2002, 646.3576, 644.515, 646.05485, 647.5947, 643.2575999999999, 638.9205, 622.74385, 606.5672, 594.79455, 583.0219, 548.9694, 514.9169, 517.7531, 520.5893, 530.065, 539.5407, 567.8827, 596.2247, 639.4998499999999, 682.775, 715.51175, 748.2485, 776.13935, 804.0302, 808.89585, 813.7615, 831.4721, 849.1827, 860.87695, 872.5712, 861.9733, 851.3754, 854.3824, 857.3894, 845.67185, 833.9543, 831.56005, 829.1658, 833.70755, 838.2493, 839.00135, 839.7534, 823.93605, 808.1187, 778.7478, 749.3769, 734.1736, 718.9703, 717.1604, 715.3505, 714.09065, 712.8308, 724.3284, 735.826, 737.20645, 738.5869, 720.0379, 701.4889, 689.3698999999999, 677.2509, 645.89995, 614.549, 604.31245, 594.0759, 613.3234500000001, 632.571, 675.45625, 718.3415, 761.3787500000001, 804.416, 834.8929, 865.3698, 873.84275, 882.3157, 876.76745, 871.2192, 881.4131, 891.607, 863.14815, 834.6893, 829.72525, 824.7612, 784.4397, 744.1182, 704.3426, 664.567, 659.5081, 654.4492, 655.0894000000001, 655.7296, 658.90095, 662.0723, 673.58465, 685.097, 664.5621, 644.0272, 633.086, 622.1448, 599.5355, 576.9262, 548.02, 519.1138, 509.4059, 499.698, 502.37035000000003, 505.0427, 524.2551, 543.4675, 560.4502, 577.4329, 582.69525, 587.9576, 578.91595, 569.8743, 589.5944, 609.3145, 579.91435, 550.5142, 549.6536, 548.793, 546.85915, 544.9253, 552.4953, 560.0653, 553.0255500000001, 545.9858, 544.65625, 543.3267, 500.0013, 456.6759, 446.85845, 437.041, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN], [NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, 649.3615, 687.7047, 726.0479, 723.45505, 720.8622, 725.59355, 730.3249, 713.5400999999999, 696.7553, 672.34115, 647.927, 621.6663000000001, 595.4056, 579.97675, 564.5479, 572.46555, 580.3832, 583.59085, 586.7985, 589.3986, 591.9987, 593.9531999999999, 595.9077, 602.8284, 609.7491, 604.35775, 598.9664, 604.59055, 610.2147, 607.7606000000001, 605.3065, 599.9941, 594.6817, 571.87235, 549.063, 545.4875999999999, 541.9122, 548.37565, 554.8391, 578.24335, 601.6476, 634.30745, 666.9673, 698.24945, 729.5316, 758.4842, 787.4368, 792.7107, 797.9846, 822.2469, 846.5092, 850.3166, 854.124, 842.4735000000001, 830.823, 837.63315, 844.4433, 848.98585, 853.5284, 872.4994, 891.4704, 914.1365000000001, 936.8026, 940.5422, 944.2818, 923.13555, 901.9893, 882.4559999999999, 862.9227, 844.2358999999999, 825.5491, 850.75065, 875.9522, 888.8668, 901.7814, 898.121, 894.4606, 899.24285, 904.0251, 881.1404, 858.2557, 859.3376000000001, 860.4195, 832.7837, 805.1479, 790.5208, 775.8937, 791.2405, 806.5873, 825.8195000000001, 845.0517, 864.76875, 884.4858, 912.6761, 940.8664, 946.4355, 952.0046, 950.5370499999999, 949.0695, 964.6876, 980.3057, 966.7093500000001, 953.113, 950.9555, 948.798, 915.95205, 883.1061, 835.20295, 787.2998, 767.06735, 746.8349, 742.8955, 738.9561, 745.6369, 752.3177, 748.9799499999999, 745.6422, 723.08275, 700.5233, 695.30735, 690.0914, 648.78615, 607.4809, 568.29, 529.0991, 514.2914499999999, 499.4838, 493.49064999999996, 487.4975, 517.85955, 548.2216, 565.4636, 582.7056, 586.4997000000001, 590.2938, 575.96335, 561.6329, 555.4273499999999, 549.2218, 529.57695, 509.9321, 489.0951, 468.2581, 476.87425, 485.4904, 483.91465000000005, 482.3389, 473.0286, 463.7183, 466.2546, 468.7909, 442.19265, 415.5944, 385.42145, 355.2485, 368.70844999999997, 382.1684, 369.47455, 356.7807, 390.21770000000004, 423.6547, 406.90605, 390.1574, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN], [NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, 618.4418, 652.1735, 685.9052, 687.98805, 690.0709, 709.2598, 728.4487, 728.5607500000001, 728.6728, 691.6730500000001, 654.6733, 620.1523, 585.6313, 565.52295, 545.4146, 550.2326, 555.0506, 566.8269, 578.6032, 585.66525, 592.7273, 589.3536, 585.9799, 586.3987, 586.8175, 591.28115, 595.7448, 605.33505, 614.9253, 611.03055, 607.1358, 604.35445, 601.5731, 589.55705, 577.541, 552.36035, 527.1797, 531.90335, 536.627, 545.53015, 554.4333, 599.7099499999999, 644.9866, 671.37875, 697.7709, 729.57485, 761.3788, 784.36355, 807.3483, 806.43635, 805.5244, 824.5507, 843.577, 856.45405, 869.3311, 859.4662000000001, 849.6013, 834.71535, 819.8294, 833.0797, 846.33, 889.74005, 933.1501, 945.7919999999999, 958.4339, 942.21435, 925.9948, 908.79645, 891.5981, 880.5263500000001, 869.4546, 851.1338000000001, 832.813, 862.6094, 892.4058, 918.06385, 943.7219, 954.6451999999999, 965.5685, 944.1549, 922.7413, 899.60445, 876.4676, 870.5262, 864.5848, 829.87195, 795.1591, 791.84485, 788.5306, 802.3709, 816.2112, 868.1441, 920.077, 945.86695, 971.6569, 977.5427, 983.4285, 953.2315, 923.0345, 937.47795, 951.9214, 981.5812, 1011.241, 1011.1184499999999, 1010.9959, 980.1533, 949.3107, 877.75355, 806.1964, 788.0363, 769.8762, 753.51055, 737.1449, 749.46495, 761.785, 753.40305, 745.0211, 753.9864500000001, 762.9518, 739.56375, 716.1757, 693.8682, 671.5607, 605.3832, 539.2057, 514.08205, 488.9584, 477.53274999999996, 466.1071, 492.06010000000003, 518.0131, 548.8467499999999, 579.6804, 586.2396, 592.7988, 583.5219500000001, 574.2451, 561.4995, 548.7539, 531.8586, 514.9633, 496.97375, 478.9842, 457.7761, 436.568, 455.3261, 474.0842, 486.303, 498.5218, 478.0383, 457.5548, 451.23995, 444.9251, 398.09235, 351.2596, 353.9677, 356.6758, 358.2278, 359.7798, 376.37485000000004, 392.9699, 404.50055, 416.0312, 403.75419999999997, 391.4772, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN], [NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, 548.3259, 521.4350000000001, 494.5441, 519.7637, 544.9833, 535.6737, 526.3641, 557.2153000000001, 588.0665, 597.60915, 607.1518, 618.1505, 629.1492, 624.4668999999999, 619.7846, 583.58195, 547.3793, 523.0823, 498.7853, 483.076, 467.3667, 465.8043, 464.2419, 485.2806, 506.3193, 508.66864999999996, 511.018, 528.82005, 546.6221, 556.24085, 565.8596, 577.2457999999999, 588.632, 606.8208999999999, 625.0098, 619.0722000000001, 613.1346, 607.7822, 602.4298, 575.1813500000001, 547.9329, 526.75145, 505.57, 516.1259, 526.6818, 542.233, 557.7842, 605.1468500000001, 652.5095, 678.1345, 703.7595, 732.8029, 761.8463, 776.4585, 791.0707, 789.54105, 788.0114, 812.67505, 837.3387, 854.5974, 871.8561, 860.7641, 849.6721, 826.2609, 802.8497, 810.5262, 818.2027, 856.2401500000001, 894.2776, 912.1441500000001, 930.0107, 928.59135, 927.172, 936.8701000000001, 946.5682, 958.47165, 970.3751, 967.9265499999999, 965.478, 992.64685, 1019.8157, 1058.7749, 1097.7341, 1124.3544, 1150.9747, 1130.45885, 1109.943, 1080.2350999999999, 1050.5272, 1021.1049499999999, 991.6827, 960.6318, 929.5809, 926.7111, 923.8413, 955.21165, 986.582, 1067.35325, 1148.1245, 1187.7624, 1227.4003, 1216.0594, 1204.7185, 1147.6581, 1090.5977, 1071.73865, 1052.8796, 1088.4600500000001, 1124.0405, 1104.99775, 1085.955, 1046.6169, 1007.2788, 938.16785, 869.0569, 852.0782, 835.0995, 826.2807, 817.4619, 855.1233, 892.7847, 909.04245, 925.3002, 950.69335, 976.0865, 932.1369, 888.1873, 815.59015, 742.993, 665.11135, 587.2297, 565.4762499999999, 543.7228, 518.2499, 492.777, 504.08105, 515.3851, 520.8341499999999, 526.2832, 526.2905499999999, 526.2979, 529.9014999999999, 533.5051, 532.04755, 530.59, 520.1084000000001, 509.6268, 498.63935000000004, 487.6519, 473.38105, 459.1102, 461.47900000000004, 463.8478, 468.9649, 474.082, 464.823, 455.564, 440.3954, 425.2268, 376.59805, 327.9693, 330.36794999999995, 332.7666, 326.0398, 319.313, 327.35749999999996, 335.402, 360.4699, 385.5378, 372.90845, 360.2791, 359.30550000000005, 358.3319, 345.2804, 332.2289, 343.25155, 354.2742, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN], [NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, 541.0766, 507.99165, 474.9067, 475.40160000000003, 475.8965, 461.35155, 446.8066, 464.52605, 482.2455, 512.9721999999999, 543.6989, 533.0497, 522.4005, 556.95395, 591.5074, 600.4553, 609.4032, 588.8318999999999, 568.2606, 529.41575, 490.5709, 463.96555, 437.3602, 438.19815, 439.0361, 431.2771, 423.5181, 451.33209999999997, 479.1461, 496.0132, 512.8803, 517.0167, 521.1531, 547.5482999999999, 573.9435, 589.65215, 605.3608, 616.5993000000001, 627.8378, 619.0513000000001, 610.2648, 581.99095, 553.7171, 537.0708, 520.4245, 498.00559999999996, 475.5867, 489.24035000000003, 502.894, 544.8847499999999, 586.8755, 632.2891, 677.7027, 711.6524, 745.6021, 762.49305, 779.384, 800.3987500000001, 821.4135, 810.15755, 798.9016, 820.7536, 842.6056, 863.73305, 884.8605, 836.9984999999999, 789.1365, 772.4403, 755.7441, 809.0137500000001, 862.2834, 906.94735, 951.6113, 943.2789, 934.9465, 929.1261, 923.3057, 932.2429, 941.1801, 949.66015, 958.1402, 968.7401500000001, 979.3401, 1051.294, 1123.2479, 1162.6853, 1202.1227, 1191.4112, 1180.6997, 1156.4196, 1132.1395, 1094.14115, 1056.1428, 1056.3154, 1056.488, 1011.1001000000001, 965.7122, 948.3374, 930.9626, 1004.7248999999999, 1078.4872, 1205.2389, 1331.9906, 1372.5591, 1413.1276, 1356.20215, 1299.2767, 1255.67015, 1212.0636, 1200.2091500000001, 1188.3547, 1186.104, 1183.8533, 1133.37955, 1082.9058, 981.5318, 880.1578, 863.11385, 846.0699, 865.97615, 885.8824, 924.02215, 962.1619, 993.9468999999999, 1025.7319, 1039.3978499999998, 1053.0638, 1038.1334, 1023.203, 926.1245, 829.046, 756.0211, 682.9962, 614.09175, 545.1873, 514.5657, 483.9441, 499.1141, 514.2841, 521.3543500000001, 528.4246, 526.88665, 525.3487, 534.45235, 543.556, 533.8626, 524.1692, 517.1858, 510.2024, 522.2483500000001, 534.2943, 517.41435, 500.5344, 471.71885, 442.9033, 461.88435000000004, 480.8654, 497.8578, 514.8502, 469.43724999999995, 424.0243, 393.4249, 362.8255, 337.83529999999996, 312.8451, 291.92695000000003, 271.0088, 307.7712, 344.5336, 338.90004999999996, 333.2665, 344.9588, 356.6511, 355.0347, 353.4183, 336.16375, 318.9092, 326.7831, 334.657, 328.08709999999996, 321.5172, 318.53885, 315.5605, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN], [NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, 512.4296, 507.6698, 502.91, 497.8598, 492.8096, 465.46434999999997, 438.1191, 440.0073, 441.8955, 425.08865000000003, 408.2818, 419.59619999999995, 430.9106, 464.9012, 498.8918, 494.92885, 490.9659, 524.9693, 558.9727, 566.75765, 574.5426, 552.87005, 531.1975, 506.0014, 480.8053, 453.9814, 427.1575, 433.3942, 439.6309, 440.9656, 442.3003, 463.129, 483.9577, 499.47754999999995, 514.9974, 510.55409999999995, 506.1108, 524.855, 543.5992, 552.9337, 562.2682, 581.02875, 599.7893, 600.15845, 600.5276, 577.10365, 553.6797, 537.37555, 521.0714, 496.83765000000005, 472.6039, 486.12645, 499.649, 529.75965, 559.8703, 598.51235, 637.1544, 688.15635, 739.1583, 770.7355500000001, 802.3128, 821.09685, 839.8809, 823.1741999999999, 806.4675, 834.5234, 862.5793, 882.9793, 903.3793, 845.6921, 788.0049, 775.9119499999999, 763.819, 822.1875, 880.556, 917.3718, 954.1876, 945.35025, 936.5129, 927.1379999999999, 917.7631, 942.89555, 968.028, 968.9893500000001, 969.9507, 941.6990000000001, 913.4473, 981.3257, 1049.2041, 1121.1714499999998, 1193.1388, 1187.31945, 1181.5001, 1157.1296499999999, 1132.7592, 1082.7588, 1032.7584, 1041.9875499999998, 1051.2167, 1034.0758, 1016.9349, 1008.4199, 999.9049, 1085.4650000000001, 1171.0251, 1311.64475, 1452.2644, 1477.3324499999999, 1502.4005, 1448.15345, 1393.9064, 1350.2413999999999, 1306.5764, 1313.39295, 1320.2095, 1324.5832, 1328.9569, 1236.8319, 1144.7069, 1040.86625, 937.0256, 944.2998, 951.574, 960.27035, 968.9667, 978.741, 988.5153, 1011.13615, 1033.757, 1076.8393, 1119.9216, 1131.7468, 1143.572, 1031.02, 918.468, 806.9309000000001, 695.3938, 627.92235, 560.4509, 541.09595, 521.741, 527.5496499999999, 533.3583, 550.4222, 567.4861, 581.2478, 595.0095, 617.5944, 640.1793, 621.04175, 601.9042, 578.5811, 555.258, 542.6587, 530.0594, 512.249, 494.4386, 479.60675000000003, 464.7749, 489.38475, 513.9946, 522.1646000000001, 530.3346, 488.49515, 446.6557, 398.57655, 350.4974, 324.3754, 298.2534, 280.55330000000004, 262.8532, 288.2905, 313.7278, 310.43245, 307.1371, 328.36105, 349.585, 357.77004999999997, 365.9551, 332.99685, 300.0386, 294.87325, 289.7079, 283.0261, 276.3443, 275.85159999999996, 275.3589, 277.12225, 278.8856, 274.2202, 269.5548, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN], [NaN, NaN, NaN, NaN, 581.7717, 560.84445, 539.9172, 595.3616666666667, 576.996, 591.8285999999999, 655.9167, 704.22476, 574.9807, 567.58735, 514.1855, 467.90554000000003, 503.4338, 550.3229299999999, 460.8427, 421.48972, 511.516, 643.6137600000001, 604.1752, 549.80745, 552.6481, 565.55658, 580.6948, 665.9475299999999, 656.9928, 575.1882499999999, 543.7498, 574.20884, 520.5294, 508.81140000000005, 521.4861, 541.25188, 541.0558, 548.8388, 556.6601, 556.25012, 585.7626, 592.94895, 561.168, 523.62706, 506.4223, 517.11332, 531.5836, 559.10082, 546.5499, 552.95935, 582.8315, 621.3264900000001, 614.4684, 587.3739300000001, 574.9097, 553.19735, 535.0878, 531.7473699999999, 514.3206, 494.18033, 532.9744, 587.7847300000001, 575.3471, 604.30239, 665.8403, 716.84399, 710.9656, 714.0115900000001, 735.1249, 767.3108100000001, 801.4954, 830.4522, 844.9817, 822.14196, 909.8604, 984.49442, 957.6582, 916.37906, 844.4105, 782.06327, 796.5932, 834.6999000000001, 875.3501, 946.81676, 941.7115, 985.45333, 962.8356, 937.8848, 930.9603, 909.0187900000001, 913.2085, 909.9066699999998, 888.904, 866.829, 853.2519, 839.8044199999999, 931.3747, 1014.11557, 997.2827, 978.40005, 975.0304, 978.61137, 992.8392, 970.7926400000001, 949.3373, 929.5206300000001, 966.5017, 1025.4457200000002, 970.9232, 922.21046, 966.7211, 1008.97276, 1161.0457, 1277.2911900000001, 1418.3097, 1489.1614499999998, 1405.0791, 1331.3160500000001, 1287.9779, 1225.93556, 1198.8375, 1199.65963, 1252.0691, 1318.3541600000003, 1394.5758, 1431.0627, 1309.9574, 1103.60541, 1059.4674, 966.7160399999999, 936.0858, 899.4123099999999, 888.9606, 934.59644, 944.4696, 958.34547, 993.5105, 1006.79538, 1040.9712, 1009.19056, 998.8513, 943.83592, 853.3556, 747.7401, 758.1098, 730.1181499999999, 677.4234, 609.7199099999999, 609.7761, 649.09681, 640.0089, 659.75332, 689.5398, 697.40964, 705.5745, 748.08432, 775.9215, 774.0373900000001, 720.2335, 679.0634200000001, 659.7914, 650.6411, 620.2064, 612.1638, 549.6833, 495.76351, 485.2012, 505.11167, 540.7698, 529.34164, 577.4736, 589.11863, 493.3266, 389.60843, 403.1473, 402.72572, 310.6499, 235.40257999999997, 269.7706, 341.68234, 343.2457, 389.58072999999996, 373.6546, 336.48445000000004, 358.2802, 386.86209, 358.4143, 292.56057, 281.2361, 302.38569, 289.6287, 288.17858, 273.8123, 270.03896, 272.6827, 280.28589, 291.3915, 299.51388, 267.69, 253.28049999999996, 261.9002, 252.76535, 243.6305, NaN, NaN, NaN, NaN], [NaN, NaN, NaN, 695.0197, 662.1657500000001, 527.2869, 623.5129333333334, 629.9558, 666.6202666666668, 612.8683, 720.7326333333334, 755.816, 804.9649499999998, 593.1181, 732.9827500000001, 474.8801, 575.90545, 581.6315, 533.9005500000001, 421.9631, 594.9511500000001, 688.2919, 681.5451333333333, 563.5271, 629.2337333333332, 575.7034, 647.4829833333333, 690.745, 679.604, 580.7678, 602.9248, 591.2607, 572.5493333333334, 522.5189, 567.3195, 568.2163, 576.4289, 575.8071, 576.8819500000001, 579.5304, 597.2602166666667, 616.3168, 578.7607666666667, 526.8953, 530.4760666666667, 515.1779, 546.4947833333334, 560.6426, 564.4078666666667, 545.942, 595.44795, 626.6185, 617.5879333333334, 589.9415, 582.9783333333335, 557.1528, 552.7732, 540.4748, 531.7674666666667, 496.1938, 557.90275, 602.291, 605.7200499999999, 605.7499, 674.9962666666668, 724.0159, 712.1647666666667, 699.8306, 736.3932666666667, 753.8643, 797.64235, 832.2717, 832.3849666666667, 819.0466, 911.8438333333334, 1009.8732, 969.1495333333332, 934.0508, 853.2717, 783.6011, 806.8338000000001, 837.828, 902.7856999999999, 954.178, 974.7626333333333, 995.4791, 962.3126666666667, 940.5715, 916.4298666666665, 900.5496, 903.8528833333335, 895.136, 875.8682, 848.1115, 831.3840333333333, 804.4241, 897.0672166666666, 987.3516, 958.7447166666666, 926.1702, 933.6443833333334, 933.9818, 940.8584333333334, 942.8011, 917.5696166666667, 901.4039, 963.4145833333334, 1023.2882, 962.7148, 900.6581, 938.4573666666666, 989.8497, 1115.73855, 1268.7028, 1362.4568000000002, 1492.1187, 1357.5546333333334, 1302.1067, 1228.875716666667, 1194.8591, 1159.5169833333334, 1171.2263, 1222.6082333333334, 1316.7969, 1355.1643666666666, 1479.6204, 1263.5127, 1119.2902, 1033.8075833333335, 972.3201, 934.6428000000001, 884.1978, 902.4208666666666, 923.5603, 936.0388666666668, 945.1478, 970.8989666666668, 989.2844, 1006.2247666666667, 978.5515, 964.7894166666667, 922.0399, 835.5642333333334, 732.9424, 756.9711, 755.6671, 697.6338833333334, 626.8759, 651.75265, 679.4836, 681.5661666666667, 687.0861, 713.1748333333334, 726.4501, 738.2321166666666, 780.7068, 801.5633166666667, 812.2863, 754.7243666666667, 704.184, 693.8784166666667, 677.6367, 660.4742, 637.1425, 580.4330833333333, 499.8027, 513.9963666666666, 509.0434, 553.43865, 531.1359, 591.3389666666667, 614.2745, 513.7307166666667, 387.3664, 422.5412166666667, 422.3133, 339.27136666666667, 224.1149, 312.9271333333333, 355.0303, 388.7237666666667, 409.36780000000005, 394.7894, 338.5153, 380.5040666666667, 394.1351000000001, 372.71735, 282.4515, 311.1118666666667, 304.2638, 312.86563333333334, 289.4667, 299.4999833333333, 268.5858, 296.81398333333334, 281.0768, 306.5766666666667, 305.8373, 294.06510000000003, 247.057, 282.2155333333333, 265.3225, 256.30353333333335, 220.0273, NaN, NaN, NaN], [NaN, NaN, 958.2198, 895.2745, 822.95385, 750.6332, 790.7044000000001, 830.7756, 845.8688, 860.962, 850.3645, 839.767, 1264.93345, 1690.0999, 1170.57725, 651.0546, 720.8487500000001, 790.6429, 680.01625, 569.3896, 761.8214499999999, 954.2533, 836.285, 718.3167, 782.405, 846.4933, 781.05935, 715.6254, 724.8263999999999, 734.0274, 721.2747999999999, 708.5222, 676.5892, 644.6562, 658.9863, 673.3164, 647.1751, 621.0338, 617.32565, 613.6175, 620.25545, 626.8934, 613.9463000000001, 600.9992, 578.5835999999999, 556.168, 576.3171500000001, 596.4663, 600.1238000000001, 603.7813, 620.68085, 637.5804, 623.827, 610.0736, 599.1156000000001, 588.1576, 588.144, 588.1304, 566.6612, 545.192, 607.75945, 670.3269, 666.46595, 662.605, 693.3081999999999, 724.0114, 714.5631, 705.1148, 738.93, 772.7452, 789.93625, 807.1273, 807.1915, 807.2557, 915.8107, 1024.3657, 992.1322, 959.8987, 870.9941, 782.0895, 827.315, 872.5405, 957.6569, 1042.7733, 1040.8649, 1038.9565, 961.2668, 883.5771, 887.3689999999999, 891.1609, 885.14165, 879.1224, 849.7966, 820.4708, 787.6483000000001, 754.8258, 828.45225, 902.0787, 881.66875, 861.2588, 850.87235, 840.4859, 836.8969, 833.3079, 854.0342499999999, 874.7606, 957.24035, 1039.7201, 946.298, 852.8759, 881.9299, 910.9839, 1025.1242499999998, 1139.2646, 1250.751, 1362.2374, 1262.5057, 1162.774, 1110.67135, 1058.5687, 1080.87595, 1103.1832, 1163.6865, 1224.1898, 1276.3415, 1328.4932, 1170.6233, 1012.7534, 982.48795, 952.2225, 931.7568, 911.2911, 929.3414, 947.3917, 919.1774, 890.9631, 925.6759, 960.3887, 936.7319, 913.0751, 896.66565, 880.2562, 799.9815000000001, 719.7068, 754.6937, 789.6806, 738.05485, 686.4291, 735.70575, 784.9824, 764.6807, 744.379, 760.4449, 776.5108, 803.54735, 830.5839, 852.84695, 875.11, 823.7061, 772.3022, 762.0524499999999, 751.8027, 741.0098, 730.2169, 641.93265, 553.6484, 571.5867000000001, 589.525, 578.77635, 568.0277, 619.0697, 670.1117, 554.53895, 438.9662, 461.32905, 483.6919, 396.5143, 309.3367, 399.2402, 489.1437, 479.6799, 470.2161, 437.05899999999997, 403.9019, 424.95180000000005, 446.0017000000001, 401.32345, 356.6452, 370.86339999999996, 385.0816, 359.3395, 333.5974, 350.87535, 368.1533, 345.07655, 321.9998, 336.947, 351.8942, 346.8153, 341.7364, 322.8462, 303.956, 281.6496, 259.3432, 237.1026, NaN, NaN], [NaN, 1232.0427, 1298.2312, 1365.175, 1259.2487, 1153.3224, 1227.0498, 1300.7772, 1265.5479, 1230.3186, 1206.90505, 1183.4915, 1157.72725, 1131.963, 1355.4751999999999, 1578.9874, 1430.7, 1282.4126, 1063.9966, 845.5806, 1137.3323500000001, 1429.0841, 1681.29095, 1933.4978, 1452.95835, 972.4189, 1007.94065, 1043.4624, 975.7430499999999, 908.0237, 882.21855, 856.4134, 804.81485, 753.2163, 737.1401000000001, 721.0639, 673.0131, 624.9623, 597.83045, 570.6986, 617.8453, 664.992, 638.17, 611.348, 606.47855, 601.6091, 629.2085, 656.8079, 649.1306500000001, 641.4534, 663.2529999999999, 685.0526, 662.2194999999999, 639.3864, 626.33875, 613.2911, 614.9646, 616.6381, 610.8728, 605.1075, 649.1986999999999, 693.2899, 698.14985, 703.0098, 759.23705, 815.4643, 784.49615, 753.528, 789.2175, 824.907, 843.8272, 862.7474, 817.0344, 771.3214, 875.1441500000001, 978.9669, 980.6157000000001, 982.2645, 900.7411500000001, 819.2178, 883.6215500000001, 948.0253, 1034.3584, 1120.6915, 1081.7991, 1042.9067, 974.6378500000001, 906.369, 909.8358000000001, 913.3026, 922.8704, 932.4382, 884.39025, 836.3423, 802.364, 768.3857, 845.0309, 921.6761, 896.665, 871.6539, 874.2454, 876.8369, 875.4908, 874.1447, 856.11555, 838.0864, 937.6686500000001, 1037.2509, 967.9498, 898.6487, 872.8331000000001, 847.0175, 971.15375, 1095.29, 1136.9270999999999, 1178.5642, 1083.9569999999999, 989.3498, 978.2272, 967.1046, 961.04555, 954.9865, 997.5226, 1040.0587, 1037.25095, 1034.4432, 972.1052999999999, 909.7674, 916.1023, 922.4372, 934.0064, 945.5756, 979.1949, 1012.8142, 970.27325, 927.7323, 980.1974, 1032.6625, 1023.26645, 1013.8704, 988.0708, 962.2712, 862.97675, 763.6823, 785.84225, 808.0022, 786.2653, 764.5284, 765.62985, 766.7313, 772.8343500000001, 778.9374, 773.117, 767.2966, 805.5666, 843.8366, 879.202, 914.5674, 857.18105, 799.7947, 811.9617000000001, 824.1287, 816.90755, 809.6864, 746.8437, 684.001, 672.5826, 661.1642, 702.0820000000001, 742.9998, 711.4516000000001, 679.9034, 619.67655, 559.4497, 661.49265, 763.5356, 612.028, 460.5204, 572.14155, 683.7627, 676.56605, 669.3694, 583.98945, 498.6095, 597.3848, 696.1601, 632.7191, 569.2781, 571.74975, 574.2214, 588.83105, 603.4407, 588.6277, 573.8147, 563.99245, 554.1702, 540.06515, 525.9601, 507.7729, 489.5857, 563.8478, 638.1099, 542.8104500000001, 447.511, 931.892325, 708.0938, NaN], [1340.5432, 1580.1278, 1641.8187, 2073.7151, 1890.5949999999998, 1707.4749, 1865.74165, 2024.0084, 1861.2565, 1698.5046, 1753.1876499999998, 1807.8707, 1735.88825, 1663.9058, 1592.29215, 1520.6785, 1577.7815, 1634.8845, 1432.0531999999998, 1229.2219, 1763.1633, 2297.1047, 1844.58045, 1392.0562, 1394.59455, 1397.1329, 1329.40075, 1261.6686, 1157.2242, 1052.7798, 953.41845, 854.0571, 758.4920999999999, 662.9271, 638.0299, 613.1327, 561.0903000000001, 509.0479, 519.02705, 529.0062, 538.07965, 547.1531, 538.4907000000001, 529.8283, 535.16155, 540.4948, 580.7972500000001, 621.0997, 608.2493999999999, 595.3991, 636.72235, 678.0456, 652.0554500000001, 626.0653, 602.6982499999999, 579.3312, 574.3714, 569.4116, 551.6927499999999, 533.9739, 590.2028, 646.4317, 646.376, 646.3203, 752.9694, 859.6185, 837.61895, 815.6194, 855.2231, 894.8268, 930.5079000000001, 966.189, 909.7145499999999, 853.2401, 920.14985, 987.0596, 957.36645, 927.6733, 897.3575000000001, 867.0417, 905.8141, 944.5865, 960.3471, 976.1077, 1016.3603, 1056.6129, 993.6146000000001, 930.6163, 967.0699999999999, 1003.5237, 984.60695, 965.6902, 1005.1729, 1044.6556, 1025.1810500000001, 1005.7065, 1073.2138, 1140.7211, 1109.6581, 1078.5951, 1056.4211, 1034.2471, 1033.2423, 1032.2375, 988.6083, 944.9791, 976.5880999999999, 1008.1971, 960.8742, 913.5513, 987.7203, 1061.8893, 1085.71225, 1109.5352, 1218.2416, 1326.948, 1204.1975, 1081.447, 1087.59355, 1093.7401, 1016.2388, 938.7375, 962.8012, 986.8649, 927.81155, 868.7582, 861.57745, 854.3967, 860.7184500000001, 867.0402, 916.74805, 966.4559, 1072.06565, 1177.6754, 1254.79125, 1331.9071, 1369.48365, 1407.0602, 1355.2847499999998, 1303.5093, 1424.07925, 1544.6492, 1278.6374500000002, 1012.6257, 1079.4394, 1146.2531, 986.6130499999999, 826.973, 768.2054499999999, 709.4379, 695.10595, 680.774, 741.22075, 801.6675, 825.47165, 849.2758, 879.16455, 909.0533, 932.0148, 954.9763, 937.3423, 919.7083, 924.49245, 929.2766, 894.7663, 860.256, 880.69795, 901.1399, 887.5074, 873.8749, 991.13025, 1108.3856, 947.9755, 787.5654, 1264.7785, 1741.9916, 1263.88645, 785.7813, 1180.6727, 1575.5641, 1286.89465, 998.2252, 926.2003500000001, 854.1755, 1081.7799, 1309.3843, 1128.6751, 947.9659, 1169.661, 1391.3561, 1272.6934999999999, 1154.0309, 1198.1367500000001, 1242.2426, 1214.57145, 1186.9003, 1185.84865, 1184.797, 1110.5572, 1036.3174, 1146.49805, 1256.6787, 1334.9685, 1413.2583, 1626.68205, 1840.1058, 1707.2365]
            // ];

            for (var i = 0; i < Z.length; i++) {
                for (var j = 0; j < Z[i].length; j++) {
                    if (Z[i][j] < -1000000) {
                        Z[i][j] = null;
                    }
                }
            }

            console.log(Z);

            // Log the data to check if it's retrieved correctly
            console.log('X:', X);
            console.log('Y:', Y);
            console.log('Z:', Z);

            // Define the dimensions and margins for the plot
            const margin = { top: 20, right: 20, bottom: 30, left: 40 };
            const width = 800 - margin.left - margin.right;
            const height = 400 - margin.top - margin.bottom;

            // const logZi = Z;

            // console.log("logZi:",logZi)

            // const cleanedZValues = logZi.map(subArray => subArray.filter(value => !isNaN(value)));
            
            // const maxValue = cleanedZValues.reduce((max,subArray)=>{
            //     const subArrayMax = Math.max(...subArray);
            //         return Math.max(max,subArrayMax);

            // },-Infinity);

            // console.log("maxValue",maxValue);

            // const logZ = logZi.map(linha=>linha.map(valor=>valor / maxValue));

            // for(let i =0;i <logZ.length;i++){
            //     for(let j=0;j<logZ[i].length;j++){
            //         if(isNaN(logZ[i][j])){
            //             logZ[i][j] = null;
            //         }
            //     }
            // }
         
            // console.log("logZ:", logZ);

            const ZFiltered = Z.flat().filter(value => value !== null);

            const minn = Math.min(...ZFiltered)
            const maxx = Math.max(...ZFiltered)
            console.log("min:",minn);
            console.log("max:",maxx);

            // Append SVG to the div
        
            // Define scales for x and y axes
            const xScale = d3.scaleLinear()
                .domain(d3.extent(X))
                .range([margin.left,width - margin.right]);

            const yScale = d3.scaleLinear()
                .domain(d3.extent(Y))
                .range([height - margin.bottom, margin.top]);

            const colorScale = d3.scaleSequential(d3.interpolateViridis)
                .domain(d3.extent(ZFiltered));

            const nice = d3.nice(Math.log2(minn), Math.log2(maxx), 11)
            const thresholds = d3.ticks(nice[0], nice[1], 11).map(i => Math.pow(2, i))
            
            console.log("thresholds: ", thresholds)
            // Define the contour function
            const contours = d3.contours()
                .size([X.length, Y.length])
                .thresholds(thresholds)
                (Z.flat());

            const svg = d3.select("#contour-plot") //Talvez mudar aqui
                .append("svg")
                .attr("width", width)
                .attr("height", height);



            // Log the generated contours
            console.log('----------');
            console.log('Contours:', contours);

            // Create paths for the contours
            svg.selectAll("path")
                .data(contours)
                .enter().append("path")
                .attr("d", d3.geoPath(d3.geoIdentity().scale(width / X.length)))
                .attr("fill", d => colorScale(d.value))
                .attr("stroke", "black");
                

            // Log the generated paths
            console.log('Paths:', svg.selectAll("path").nodes());
           
            // Add x-axis
            svg.append("g")
                .attr("transform", `translate(0, ${height - margin.bottom}) `)
                .call(d3.axisBottom(xScale));

            // Add y-axis
            svg.append("g")
                .attr("transform",`translate(${width - margin.right + 10},${margin.top})`)
                .call(d3.axisLeft(yScale));
            const legendWidth = 20;
            const legendHeight = 200;
            
            const legendSvg = svg.append("g")
                .attr("transform", `translate(${width - margin.right + 10}, ${margin.top})`);
            
            const legendScale = d3.scaleLinear()
                .domain(d3.extent(ZFiltered))
                .range([legendHeight,0]);

            const legendAxis = d3.axisRight(legendScale).ticks(6);

            const legendData = d3.range(minn, maxx, 50);

            legendSvg.selectAll("rect")
            .data(legendData)
            .enter().append("rect")
            .attr("y", d => legendScale(d))
            .attr("height", legendHeight / legendData.length)
            .attr("width", legendWidth)
            .attr("fill", d => colorScale(d));

            legendSvg.append("g")
            .attr("transform", `translate(${legendWidth},0)`)
            .call(legendAxis);
        
            })
        .catch(error => console.error('Error fetching or parsing data:', error));
}